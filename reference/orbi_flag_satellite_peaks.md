# Flag minor satellite peaks Flags minor signals for an isotopocule that matches multiple peaks within its exact mass +/- tolerance interval in the same scan. These are often small satellite peaks generated by the Fourier transform. However, if there are satelite peaks of high intensity or very many satellite peaks, it can indicate that the m/z and tolerance setting used for identifying isotopcules need to be revisited. Visualize the flagged satellite peaks with [`orbi_plot_satellite_peaks()`](https://isoorbi.isoverse.org/reference/orbi_plot_satellite_peaks.md).

Flag minor satellite peaks Flags minor signals for an isotopocule that
matches multiple peaks within its exact mass +/- tolerance interval in
the same scan. These are often small satellite peaks generated by the
Fourier transform. However, if there are satelite peaks of high
intensity or very many satellite peaks, it can indicate that the m/z and
tolerance setting used for identifying isotopcules need to be revisited.
Visualize the flagged satellite peaks with
[`orbi_plot_satellite_peaks()`](https://isoorbi.isoverse.org/reference/orbi_plot_satellite_peaks.md).

## Usage

``` r
orbi_flag_satellite_peaks(dataset)
```

## Arguments

- dataset:

  An aggregated dataset or a data frame of peaks (i.e. works directly
  after
  [`orbi_identify_isotopocules()`](https://isoorbi.isoverse.org/reference/orbi_identify_isotopocules.md)
  as well as with a tibble from [orbi_get_data(peaks =
  everything())](https://isoorbi.isoverse.org/reference/orbi_get_data.md)
  or when reading from an IsoX file)

## Value

same object as provided in `dataset` with new column `is_satellite_peak`
that flags satellite peaks

## Examples

``` r
fpath <- system.file("extdata", "testfile_flow.isox", package = "isoorbi")
df <-
  orbi_read_isox(file = fpath) |>
  orbi_simplify_isox() |>
  orbi_flag_satellite_peaks()
#> ✔ [20ms] orbi_read_isox() loaded 6449 peaks for 1 compound (HSO4-) with 5
#> isotopocules (M0, 33S, 17O, 34S, and 18O) from testfile_flow.isox
#> ✔ [5ms] orbi_simplify_isox() kept columns filepath, filename, scan.no,
#> time.min, compound, isotopocule, ions.incremental, tic, and it.ms
#> ✔ [122ms] orbi_flag_satellite_peaks() confirmed there are no satellite peaks
```
