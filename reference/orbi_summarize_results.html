<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="Contains the logic to generate the results table. It passes the  ratio_method parameter to the orbi_calculate_summarized_ratio() function for ratio calculations."><title>Generate the results table — orbi_summarize_results • isoorbi</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><link href="../deps/Roboto-0.4.7/font.css" rel="stylesheet"><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Generate the results table — orbi_summarize_results"><meta property="og:description" content="Contains the logic to generate the results table. It passes the  ratio_method parameter to the orbi_calculate_summarized_ratio() function for ratio calculations."><meta property="og:image" content="https://isoorbi.isoverse.org/logo.png"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-default navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">isoorbi</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Released version">1.2.0</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item">
  <a class="nav-link" href="../articles/quick_start.html">Quick Start</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../articles/dual_inlet.html">Dual Inlet</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../articles/isoxl_demo.html">IsoXL demo GUI</a>
</li>
<li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/isoverse/isoorbi">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Generate the results table</h1>
      <small class="dont-index">Source: <a href="https://github.com/isoverse/isoorbi/blob/HEAD/R/ratio_functions.R" class="external-link"><code>R/ratio_functions.R</code></a></small>
      <div class="d-none name"><code>orbi_summarize_results.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Contains the logic to generate the results table. It passes the  <code>ratio_method</code> parameter to the <code><a href="orbi_calculate_summarized_ratio.html">orbi_calculate_summarized_ratio()</a></code> function for ratio calculations.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">orbi_summarize_results</span><span class="op">(</span></span>
<span>  <span class="va">dataset</span>,</span>
<span>  ratio_method <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"mean"</span>, <span class="st">"sum"</span>, <span class="st">"median"</span>, <span class="st">"geometric_mean"</span>, <span class="st">"slope"</span>, <span class="st">"weighted_sum"</span><span class="op">)</span>,</span>
<span>  .by <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"block"</span>, <span class="st">"sample_name"</span>, <span class="st">"segment"</span>, <span class="st">"data_group"</span>, <span class="st">"data_type"</span>, <span class="st">"injection"</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>dataset</dt>
<dd><p>A tibble from <code>IsoX</code> output (<code><a href="orbi_read_isox.html">orbi_read_isox()</a></code>) and with a basepeak already defined (using <code><a href="orbi_define_basepeak.html">orbi_define_basepeak()</a></code>). Optionally, with block definitions (<code><a href="orbi_define_blocks_for_dual_inlet.html">orbi_define_blocks_for_dual_inlet()</a></code>) or even additional block segments (<code><a href="orbi_segment_blocks.html">orbi_segment_blocks()</a></code>).</p></dd>


<dt>ratio_method</dt>
<dd><p>Method for computing the ratio. <strong>Please note well</strong>: the formula used to calculate ion ratios matters! Do not simply use arithmetic mean. The best option may depend on the type of data you are processing (e.g., MS1 versus M+1 fragmentation). <code>ratio_method</code> can be one of the following:</p><ul><li><p><code>mean</code>: arithmetic mean of ratios from individual scans.</p></li>
<li><p><code>sum</code>: sum of all ions of the numerator across all scans divided by the sum of all ions observed for the denominator across all scans.</p></li>
<li><p><code>geometric_mean</code>: geometric mean of ratios from individual scans.</p></li>
<li><p><code>slope</code>: The ratio is calculated using the slope obtained from a linear regression model that is weighted by the <code>numerator x</code>, using <code>stats::lm(x ~ y + 0, weights = x)</code>.</p></li>
<li><p><code>weighted_sum</code>: A derivative of the <code>sum</code> option. The weighing function ensures that each scan contributes equal weight to the ratio calculation,
i.e. scans with more ions in the Orbitrap do not contribute disproportionately to the total <code>sum</code> of <code>x</code> and <code>y</code> that is used to calculate <code>x/y</code>.</p></li>
</ul></dd>


<dt>.by</dt>
<dd><p>additional grouping columns for the results summary (akin to dplyr's <code>.by</code> parameter e.g. in <code><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">dplyr::summarize()</a></code>). If not set by the user, all columns in the parameter's default values are used, if present in the dataset. Note that the order of these is also used to arrange the summary.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    

<p>Returns a results summary table retaining the columns <code>filename</code>, <code>compound</code>, <code>isotopocule</code> and <code>basepeak</code> as well as the grouping columns from the <code>.by</code> parameter that are part of the input <code>dataset</code>. Additionally this function adds the following results columns: <code>start_scan.no</code>, <code>end_scan.no</code>, <code>start_time.min</code>, <code>mean_time.min</code>, <code>end_time.min</code>, <code>ratio</code>, <code>ratio_sem</code>, <code>ratio_relative_sem_permil</code>, <code>shot_noise_permil</code>, <code>No.of.Scans</code>, <code>minutes_to_1e6_ions</code></p>


<ul><li><p><code>ratio</code>: The isotope ratio between the <code>isotopocule</code> and the <code>basepeak</code>, calculated using the <code>ratio_method</code></p></li>
<li><p><code>ratio_sem</code>: Standard error of the mean for the ratio</p></li>
<li><p><code>number_of_scans</code>: Number of scans used for the final ratio calculation</p></li>
<li><p><code>minutes_to_1e6_ions</code>: Time in minutes it would take to observe 1 million ions of the <code>isotopocule</code> used as numerator of the ratio calculation.</p></li>
<li><p><code>shot_noise_permil</code>: Estimate of the shot noise (more correctly thermal noise) of the reported ratio in permil.</p></li>
<li><p><code>ratio_relative_sem_permil</code>: Relative standard error of the reported ratio in permil</p></li>
</ul></div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="va">fpath</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"testfile_flow.isox"</span>, package <span class="op">=</span> <span class="st">"isoorbi"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="orbi_read_isox.html">orbi_read_isox</a></span><span class="op">(</span>file <span class="op">=</span> <span class="va">fpath</span><span class="op">)</span> <span class="op">|&gt;</span></span></span>
<span class="r-in"><span>      <span class="fu"><a href="orbi_simplify_isox.html">orbi_simplify_isox</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span></span>
<span class="r-in"><span>      <span class="fu"><a href="orbi_define_basepeak.html">orbi_define_basepeak</a></span><span class="op">(</span><span class="st">"M0"</span><span class="op">)</span>  <span class="op">|&gt;</span></span></span>
<span class="r-in"><span>      <span class="fu">orbi_summarize_results</span><span class="op">(</span>ratio_method <span class="op">=</span> <span class="st">"sum"</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> orbi_read_isox() is loading .isox data from 1 file(s)...</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> - loaded 6449 peaks for 1 compounds (HSO4-) with 5 isotopocules (M0, 33S,</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>    17O, 34S, 18O) from testfile_flow.isox in 0.03 seconds.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> orbi_simplify_isox() will keep only columns 'filename', 'compound',</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>    'scan.no', 'time.min', 'isotopocule', 'ions.incremental', 'tic',</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>    'it.ms'...</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>    ...complete in 0.01 seconds.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> orbi_define_basepeak() is setting the 'M0' isotopocule as the ratio</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>    denominator...</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>    ...base peak set for 4 isotopocules ('33S', '17O', '34S', '18O') in 0.10</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>    seconds.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> orbi_summarize_results() is grouping the data by 'filename', 'compound',</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>    'basepeak', 'isotopocule' and summarizing ratios using the 'sum' method...</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>    ...completed in 0.03 seconds.</span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by Caj Neubauer, Sebastian Kopf, Kristýna Kantnerová.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer></div>

  

  

  </body></html>

